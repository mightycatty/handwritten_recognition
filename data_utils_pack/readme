utils functions for data processing and preparation